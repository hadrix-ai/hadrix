import type { EvalGroupSpec } from "../../../types.js";

const NEXTJS_CASE = "cases/nextjs-baseline";
const NEXTJS_FAKEOUT_1_CASE = "cases/nextjs-fakeout-1";
const SUPABASE_CASE = "cases/supabase-baseline";
const BROKENCRYSTALS_CASE = "cases/brokencrystals-baseline";

export const VULNERABLE_DEPS_GROUPS: EvalGroupSpec[] = [
  {
    id: "VULNERABLE-DEPS-Nextjs-Baseline",
    description:
      "Vulnerable dependencies baseline fixtures (Next.js) in hadrix-evals-vulnerable-deps",
    allowUnexpected: true,
    expectedFindings: [
      {
        filepath: `${NEXTJS_CASE}/package-lock.json`,
        expectation:
          "axios@0.21.1: Inefficient Regular Expression Complexity (ReDoS) in trim function",
        severity: "high",
      },
      {
        filepath: `${NEXTJS_CASE}/package-lock.json`,
        expectation: "lodash@4.17.20: Command Injection via template function",
        severity: "high",
      },
      {
        filepath: `${NEXTJS_CASE}/package-lock.json`,
        expectation: "lodash@4.17.20: Regular Expression Denial of Service (ReDoS)",
        severity: "medium",
      },
      {
        filepath: `${NEXTJS_CASE}/package-lock.json`,
        expectation: "lodash@4.17.20: Prototype Pollution in zipObjectDeep",
        severity: "high",
      },
      {
        filepath: `${NEXTJS_CASE}/package-lock.json`,
        expectation:
          "jsonwebtoken@8.5.1: Unrestricted key type could lead to signature validation bypass",
        severity: "high",
      },
      {
        filepath: `${NEXTJS_CASE}/package-lock.json`,
        expectation: "jsonwebtoken@8.5.1: Algorithm confusion when using asymmetric keys",
        severity: "medium",
      },
    ],
  },
  {
    id: "VULNERABLE-DEPS-Nextjs-Fakeout1",
    description:
      "Vulnerable dependencies fakeout fixtures (Next.js) in hadrix-evals-vulnerable-deps",
    allowUnexpected: true,
    expectedFindings: [
      {
        filepath: `${NEXTJS_FAKEOUT_1_CASE}/package-lock.json`,
        expectation:
          "axios@0.21.0: Inefficient Regular Expression Complexity (ReDoS) in trim function",
        severity: "high",
      },
      {
        filepath: `${NEXTJS_FAKEOUT_1_CASE}/package-lock.json`,
        expectation: "lodash@4.17.10: Command Injection via template function",
        severity: "high",
      },
      {
        filepath: `${NEXTJS_FAKEOUT_1_CASE}/package-lock.json`,
        expectation: "lodash@4.17.10: Regular Expression Denial of Service (ReDoS)",
        severity: "medium",
      },
      {
        filepath: `${NEXTJS_FAKEOUT_1_CASE}/package-lock.json`,
        expectation: "lodash@4.17.10: Prototype Pollution in zipObjectDeep",
        severity: "high",
      },
      {
        filepath: `${NEXTJS_FAKEOUT_1_CASE}/package-lock.json`,
        expectation:
          "jsonwebtoken@4.2.1: Unrestricted key type could lead to signature validation bypass",
        severity: "high",
      },
      {
        filepath: `${NEXTJS_FAKEOUT_1_CASE}/package-lock.json`,
        expectation: "jsonwebtoken@4.2.1: Algorithm confusion when using asymmetric keys",
        severity: "medium",
      },
    ],
  },
  {
    id: "VULNERABLE-DEPS-Supabase-Baseline",
    description:
      "Vulnerable dependencies baseline fixtures (React Supabase) in hadrix-evals-vulnerable-deps",
    allowUnexpected: true,
    expectedFindings: [
      {
        filepath: `${SUPABASE_CASE}/package-lock.json`,
        expectation:
          "axios@0.21.1: Inefficient Regular Expression Complexity (ReDoS) in trim function",
        severity: "high",
      },
      {
        filepath: `${SUPABASE_CASE}/package-lock.json`,
        expectation: "lodash@4.17.20: Command Injection via template function",
        severity: "high",
      },
      {
        filepath: `${SUPABASE_CASE}/package-lock.json`,
        expectation: "lodash@4.17.20: Regular Expression Denial of Service (ReDoS)",
        severity: "medium",
      },
      {
        filepath: `${SUPABASE_CASE}/package-lock.json`,
        expectation: "lodash@4.17.20: Prototype Pollution in zipObjectDeep",
        severity: "high",
      },
      {
        filepath: `${SUPABASE_CASE}/package-lock.json`,
        expectation:
          "jsonwebtoken@8.5.1: Unrestricted key type could lead to signature validation bypass",
        severity: "high",
      },
      {
        filepath: `${SUPABASE_CASE}/package-lock.json`,
        expectation: "jsonwebtoken@8.5.1: Algorithm confusion when using asymmetric keys",
        severity: "medium",
      },
    ],
  },
  {
    id: "VULNERABLE-DEPS-BrokenCrystals",
    description: "Vulnerable dependencies fixtures (BrokenCrystals) in hadrix-evals-vulnerable-deps",
    allowUnexpected: true,
    expectedFindings: [
      {
        filepath: `${BROKENCRYSTALS_CASE}/package-lock.json`,
        expectation: "axios@0.21.1: Inefficient Regular Expression Complexity (ReDoS) in trim function",
        severity: "high",
      },
      {
        filepath: `${BROKENCRYSTALS_CASE}/package-lock.json`,
        expectation: "lodash@4.17.20: Command Injection via template function",
        severity: "high",
      },
      {
        filepath: `${BROKENCRYSTALS_CASE}/package-lock.json`,
        expectation: "lodash@4.17.20: Regular Expression Denial of Service (ReDoS)",
        severity: "medium",
      },
      {
        filepath: `${BROKENCRYSTALS_CASE}/package-lock.json`,
        expectation: "lodash@4.17.20: Prototype Pollution in zipObjectDeep",
        severity: "high",
      },
      {
        filepath: `${BROKENCRYSTALS_CASE}/package-lock.json`,
        expectation: "jsonwebtoken@8.5.1: Unrestricted key type could lead to signature validation bypass",
        severity: "high",
      },
      {
        filepath: `${BROKENCRYSTALS_CASE}/package-lock.json`,
        expectation: "jsonwebtoken@8.5.1: Algorithm confusion when using asymmetric keys",
        severity: "medium",
      },
    ],
  },
];
