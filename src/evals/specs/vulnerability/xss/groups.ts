import type { EvalGroupSpec } from "../../../types.js";

const NEXTJS_CASE = "cases/nextjs-baseline";
const NEXTJS_FAKEOUT_1_CASE = "cases/nextjs-fakeout-1";
const SUPABASE_CASE = "cases/supabase-baseline";
const BROKENCRYSTALS_CASE = "cases/brokencrystals-baseline";

export const XSS_GROUPS: EvalGroupSpec[] = [
  {
    id: "XSS-Nextjs-Baseline",
    description: "XSS baseline fixtures (Next.js) in hadrix-evals-xss",
    allowUnexpected: true,
    expectedFindings: [
      {
        filepath: `${NEXTJS_CASE}/app/projects/[id]/page.tsx`,
        expectation:
          "Stored XSS: dangerouslySetInnerHTML renders project.description_html without sanitization when the toggle is enabled",
        severity: "high",
      },
    ],
  },
  {
    id: "XSS-Nextjs-Fakeout1",
    description: "XSS fakeout fixtures (Next.js) in hadrix-evals-xss",
    allowUnexpected: true,
    expectedFindings: [
      {
        filepath: `${NEXTJS_FAKEOUT_1_CASE}/app/projects/[id]/page.tsx`,
        expectation:
          "Stored XSS: dangerouslySetInnerHTML renders project.description_html after only stripping script tags",
        severity: "high",
      },
    ],
  },
  {
    id: "XSS-Supabase-Baseline",
    description: "XSS baseline fixtures (React Supabase) in hadrix-evals-xss",
    allowUnexpected: true,
    expectedFindings: [
      {
        filepath: `${SUPABASE_CASE}/frontend/app/projects/[id]/page.tsx`,
        expectation:
          "Stored XSS: dangerouslySetInnerHTML renders project.description_html without sanitization when the toggle is enabled",
        severity: "high",
      },
    ],
  },
  {
    id: "XSS-BrokenCrystals",
    description: "XSS fixtures (BrokenCrystals) in hadrix-evals-xss",
    allowUnexpected: true,
    expectedFindings: [
      {
        filepath: `${BROKENCRYSTALS_CASE}/client/TestimonialCard.tsx`,
        expectation: "Stored XSS: dangerouslySetInnerHTML renders testimonial body without sanitization",
        severity: "high",
      },
    ],
  },
];
