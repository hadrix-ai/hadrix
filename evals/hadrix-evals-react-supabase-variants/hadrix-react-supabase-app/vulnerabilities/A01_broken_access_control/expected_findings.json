[
  {
    "category": "A01_Broken_Access_Control",
    "file": "backend/supabase/functions/get-project.ts",
    "description": "IDOR: project fetched by ID without verifying org membership/ownership when toggle is enabled",
    "severity": "high"
  },
  {
    "category": "A01_Broken_Access_Control",
    "file": "backend/supabase/functions/list-projects.ts",
    "description": "Cross-tenant data leakage: client-controlled orgId and optional raw .or() filter influence listing without membership verification",
    "severity": "high"
  },
  {
    "category": "A01_Broken_Access_Control",
    "file": "backend/supabase/functions/admin-delete-user.ts",
    "description": "Admin action without role check: deletes arbitrary users when authorization toggle is enabled",
    "severity": "critical"
  },
  {
    "category": "A01_Broken_Access_Control",
    "file": "backend/supabase/functions/admin-list-users.ts",
    "description": "Admin data exposure: lists all profiles without server-side role check when toggle is enabled",
    "severity": "high"
  },
  {
    "category": "A01_Broken_Access_Control",
    "file": "frontend/admin/AdminUsers.tsx",
    "description": "Frontend-only admin gating: hides admin UI based on client metadata rather than server authorization",
    "severity": "medium"
  },
  {
    "category": "A01_Broken_Access_Control",
    "file": "backend/supabase/migrations/002_rls.sql",
    "description": "Projects RLS policies only verify the user belongs to some org, missing org scoping and allowing cross-tenant reads/writes",
    "severity": "critical"
  }
]
