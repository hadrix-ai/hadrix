import type { EvalGroupSpec } from "../../../types.js";

const NEXTJS_CASE = "cases/nextjs-baseline";
const NEXTJS_FAKEOUT_1_CASE = "cases/nextjs-fakeout-1";
const SUPABASE_CASE = "cases/supabase-baseline";
const BROKENCRYSTALS_CASE = "cases/brokencrystals-baseline";

export const SECRETS_EXPOSURE_GROUPS: EvalGroupSpec[] = [
  {
    id: "SECRETS-EXPOSURE-Nextjs-Baseline",
    description: "Secrets exposure baseline fixtures (Next.js) in hadrix-evals-secrets-exposure",
    allowUnexpected: true,
    expectedFindings: [
      {
        filepath: `${NEXTJS_CASE}/components/BillingSecrets.tsx`,
        expectation: "Hardcoded Stripe secret key is embedded in a client component and used from the browser",
        ruleId: "frontend_secret_exposure",
        severity: "high",
        startLine: 3,
        endLine: 3,
      },
      {
        filepath: `${NEXTJS_CASE}/config/local.env.json`,
        expectation: "Local environment config file is committed with plaintext secret keys",
        ruleId: "plaintext_secrets",
        severity: "high",
        startLine: 3,
        endLine: 4,
      },
    ],
  },
  {
    id: "SECRETS-EXPOSURE-Nextjs-Fakeout1",
    description: "Secrets exposure fakeout fixtures (Next.js) in hadrix-evals-secrets-exposure",
    allowUnexpected: true,
    expectedFindings: [
      {
        filepath: `${NEXTJS_FAKEOUT_1_CASE}/components/AdminDashboard.tsx`,
        expectation: "Supabase service role key is sourced from NEXT_PUBLIC env and used in client-side code",
        ruleId: "frontend_secret_exposure",
        severity: "high",
        startLine: 22,
        endLine: 23,
      },
    ],
  },
  {
    id: "SECRETS-EXPOSURE-Supabase-Baseline",
    description: "Secrets exposure baseline fixtures (React Supabase) in hadrix-evals-secrets-exposure",
    allowUnexpected: true,
    expectedFindings: [
      {
        filepath: `${SUPABASE_CASE}/frontend/components/AlertsBridge.tsx`,
        expectation: "Slack bot token is hardcoded in a client component and used to call the Slack API",
        ruleId: "frontend_secret_exposure",
        severity: "high",
        startLine: 3,
        endLine: 3,
      },
    ],
  },
  {
    id: "SECRETS-EXPOSURE-BrokenCrystals",
    description: "Secrets exposure fixtures (BrokenCrystals) in hadrix-evals-secrets-exposure",
    allowUnexpected: true,
    expectedFindings: [
      {
        filepath: `${BROKENCRYSTALS_CASE}/client/MapsPreview.tsx`,
        expectation: "Google Maps API key is embedded directly in frontend code",
        ruleId: "frontend_secret_exposure",
        severity: "high",
        startLine: 4,
        endLine: 4,
      },
    ],
  },
];
