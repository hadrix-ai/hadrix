[
  {
    "category": "A04_Cryptographic_Failures",
    "file": "lib/auth.ts",
    "description": "JWT secret fallback and decoding without verification",
    "severity": "high"
  },
  {
    "category": "A04_Cryptographic_Failures",
    "file": "app/api/tokens/route.ts",
    "description": "Token generation uses Math.random and direct token storage",
    "severity": "high"
  },
  {
    "category": "A04_Cryptographic_Failures",
    "file": "app/actions/createApiToken.ts",
    "description": "Token generation uses Math.random in server action",
    "severity": "medium"
  },
  {
    "category": "A04_Cryptographic_Failures",
    "file": "db/schema.sql",
    "description": "Token column stored as direct text in schema",
    "severity": "medium"
  },
  {
    "category": "A04_Cryptographic_Failures",
    "file": "app/login/page.tsx",
    "description": "Magic link accepted without expiration check",
    "severity": "medium"
  },
  {
    "category": "A04_Cryptographic_Failures",
    "file": "app/api/webhook/route.ts",
    "description": "Webhook signature verification uses fallback secret",
    "severity": "medium"
  }
]
