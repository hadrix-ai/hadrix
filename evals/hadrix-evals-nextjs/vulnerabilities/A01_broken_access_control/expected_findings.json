[
  {
    "category": "A01_Broken_Access_Control",
    "file": "app/api/projects/[id]/route.ts",
    "description": "IDOR: project fetched by ID without ownership check when toggle is enabled",
    "severity": "high"
  },
  {
    "category": "A01_Broken_Access_Control",
    "file": "app/api/projects/route.ts",
    "description": "Cross-tenant leakage: client-controlled orgId used for filtering and writes",
    "severity": "high"
  },
  {
    "category": "A01_Broken_Access_Control",
    "file": "app/actions/createProject.ts",
    "description": "Server action trusts client orgId for project creation",
    "severity": "high"
  },
  {
    "category": "A01_Broken_Access_Control",
    "file": "app/api/admin/users/route.ts",
    "description": "Admin list endpoint missing role checks",
    "severity": "critical"
  },
  {
    "category": "A01_Broken_Access_Control",
    "file": "app/api/admin/users/[id]/route.ts",
    "description": "Admin delete endpoint missing role checks",
    "severity": "critical"
  },
  {
    "category": "A01_Broken_Access_Control",
    "file": "components/AdminUsers.tsx",
    "description": "Frontend-only role enforcement based on client-side state",
    "severity": "medium"
  },
  {
    "category": "A01_Broken_Access_Control",
    "file": "db/rls.sql",
    "description": "Permissive RLS policies allow unrestricted access",
    "severity": "high"
  }
]
