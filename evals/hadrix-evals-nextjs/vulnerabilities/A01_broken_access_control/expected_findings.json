[
  {
    "category": "A01_Broken_Access_Control",
    "file": "app/api/projects/[id]/route.ts",
    "description": "Project fetched by ID; tenant membership gate is toggle-controlled",
    "severity": "high"
  },
  {
    "category": "A01_Broken_Access_Control",
    "file": "app/api/projects/route.ts",
    "description": "Client-supplied orgId used for filtering and writes",
    "severity": "high"
  },
  {
    "category": "A01_Broken_Access_Control",
    "file": "app/actions/createProject.ts",
    "description": "Server action uses client-supplied orgId for project creation",
    "severity": "high"
  },
  {
    "category": "A01_Broken_Access_Control",
    "file": "app/api/admin/users/route.ts",
    "description": "Admin list endpoint relies on header-based role gate when enabled",
    "severity": "critical"
  },
  {
    "category": "A01_Broken_Access_Control",
    "file": "app/api/admin/users/[id]/route.ts",
    "description": "Admin delete endpoint relies on header-based role gate when enabled",
    "severity": "critical"
  },
  {
    "category": "A01_Broken_Access_Control",
    "file": "components/AdminUsers.tsx",
    "description": "Client-side role gate based on localStorage state",
    "severity": "medium"
  },
  {
    "category": "A01_Broken_Access_Control",
    "file": "db/rls.sql",
    "description": "RLS policies configured for broad access when enabled",
    "severity": "high"
  }
]
